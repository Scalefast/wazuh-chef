driver:
  name: docker
  use_sudo: false
  use_internal_docker_network: true
  remove_images: true

transport:
  name: docker

provisioner:
  chef_license: accept

verifier:
  name: inspec

platforms:
  - name: <%= ENV['PLATFORM'] %>_<%= ENV['RELEASE'] %>
    driver_config:
      image: <%= ENV['IMAGE'] %>
      platform: <%= ENV['PLATFORM'] %>
      hostname: manager_<%= ENV['PLATFORM'] %>_<%= ENV['RELEASE'] %>
      run_command: <%= ENV['RUN_COMMAND'] %>
      privileged: true
      volume:
        - /sys/fs/cgroup:/sys/fs/cgroup:ro

suites:
  - name: wazuh_server
    run_list:
      - recipe[wazuh_manager::default]
      - recipe[filebeat::default]

  - name: wazuh_agent
    run_list:
      - recipe[wazuh_agent::default]
    atttributes:
      ossec:
        address: <%= ENV['MANAGER_IP'] %>