driver:
  name: docker
  use_sudo: false
  use_internal_docker_network: true
  remove_images: true
  use_cache: false

provisioner:
  name: chef_zero
  chef_license: accept-no-persist

platforms:
  - name: <%= ENV['PLATFORM'] %>_<%= ENV['RELEASE'] %>
    driver_config:
      image: <%= ENV['IMAGE'] %>
      platform: <%= ENV['PLATFORM'] %>
      publish_all: true
      run_command: <%= ENV['RUN_COMMAND'] %>
      privileged: true
      volume:
        - /sys/fs/cgroup:/sys/fs/cgroup:ro
     
suites:
  - name: wazuh-server
    run_list:
      - recipe[wazuh_manager::default]
      - recipe[filebeat::default]

  - name: wazuh-agent
    run_list:
      - recipe[wazuh_agent::default]
    attributes:
      ossec:
        address: <%= ENV['MANAGER_IP'] %>